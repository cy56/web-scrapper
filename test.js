const data = [{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 34,
    betAmount: 16.01,
    winloss: 10.69,
    rtp: 33.24,
    uapSpin: 34,
    uapBet: 16.01,
    betSpin: 0.47
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 2,
    spin: 729,
    betAmount: 34.54,
    winloss: -0.16,
    rtp: 100.49,
    uapSpin: 364.5,
    uapBet: 17.27,
    betSpin: 0.05
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 99,
    betAmount: 5.42,
    winloss: -4.09,
    rtp: 175.52,
    uapSpin: 99,
    uapBet: 5.43,
    betSpin: 0.05
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 2,
    spin: 62,
    betAmount: 24.96,
    winloss: 20.34,
    rtp: 18.49,
    uapSpin: 31,
    uapBet: 12.48,
    betSpin: 0.4
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 2,
    spin: 318,
    betAmount: 181.78,
    winloss: 42.95,
    rtp: 76.37,
    uapSpin: 159,
    uapBet: 90.89,
    betSpin: 0.57
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 47,
    betAmount: 35.41,
    winloss: 16.87,
    rtp: 52.34,
    uapSpin: 47,
    uapBet: 35.42,
    betSpin: 0.75
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 7,
    spin: 633,
    betAmount: 461.84,
    winloss: -129.48,
    rtp: 128.04,
    uapSpin: 90.43,
    uapBet: 65.98,
    betSpin: 0.73
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 263,
    betAmount: 99.08,
    winloss: 24.67,
    rtp: 75.1,
    uapSpin: 263,
    uapBet: 99.09,
    betSpin: 0.38
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 3,
    spin: 169,
    betAmount: 62.29,
    winloss: -50.73,
    rtp: 181.45,
    uapSpin: 56.33,
    uapBet: 20.76,
    betSpin: 0.37
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 1,
    betAmount: 0.23,
    winloss: -1.66,
    rtp: 808,
    uapSpin: 1,
    uapBet: 0.24,
    betSpin: 0.24
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 5,
    spin: 114,
    betAmount: 98.19,
    winloss: -59.01,
    rtp: 160.1,
    uapSpin: 22.8,
    uapBet: 19.64,
    betSpin: 0.86
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 124,
    betAmount: 46.71,
    winloss: 7.81,
    rtp: 83.27,
    uapSpin: 124,
    uapBet: 46.72,
    betSpin: 0.38
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 15,
    betAmount: 0.98,
    winloss: 0.69,
    rtp: 29.59,
    uapSpin: 15,
    uapBet: 0.98,
    betSpin: 0.07
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 6,
    spin: 424,
    betAmount: 181.85,
    winloss: 12.45,
    rtp: 93.15,
    uapSpin: 70.67,
    uapBet: 30.31,
    betSpin: 0.43
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 95,
    betAmount: 22.37,
    winloss: 6.4,
    rtp: 71.37,
    uapSpin: 95,
    uapBet: 22.37,
    betSpin: 0.24
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 3,
    spin: 65,
    betAmount: 27.37,
    winloss: 12.91,
    rtp: 52.82,
    uapSpin: 21.67,
    uapBet: 9.12,
    betSpin: 0.42
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 2,
    spin: 291,
    betAmount: 73.09,
    winloss: 6.37,
    rtp: 91.27,
    uapSpin: 145.5,
    uapBet: 36.55,
    betSpin: 0.25
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'CNY',
    type: 'slot',
    uap: 1,
    spin: 3,
    betAmount: 1.11,
    winloss: 0.89,
    rtp: 20,
    uapSpin: 3,
    uapBet: 1.12,
    betSpin: 0.37
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 2,
    spin: 333,
    betAmount: 156.82,
    winloss: 53.73,
    rtp: 65.74,
    uapSpin: 166.5,
    uapBet: 78.41,
    betSpin: 0.47
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 3,
    spin: 91,
    betAmount: 21.42,
    winloss: 8.19,
    rtp: 61.76,
    uapSpin: 30.33,
    uapBet: 7.14,
    betSpin: 0.24
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'CNY',
    type: 'slot',
    uap: 2,
    spin: 99,
    betAmount: 27.35,
    winloss: 4.87,
    rtp: 82.18,
    uapSpin: 49.5,
    uapBet: 13.68,
    betSpin: 0.28
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 42,
    betAmount: 9.89,
    winloss: 5.98,
    rtp: 39.52,
    uapSpin: 42,
    uapBet: 9.89,
    betSpin: 0.24
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 3,
    spin: 1976,
    betAmount: 495.62,
    winloss: 44.02,
    rtp: 91.12,
    uapSpin: 658.67,
    uapBet: 165.21,
    betSpin: 0.25
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 932,
    betAmount: 49.39,
    winloss: -0.44,
    rtp: 100.9,
    uapSpin: 932,
    uapBet: 49.39,
    betSpin: 0.05
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 16,
    betAmount: 4.01,
    winloss: 1.72,
    rtp: 57,
    uapSpin: 16,
    uapBet: 4.02,
    betSpin: 0.25
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 570,
    betAmount: 86.51,
    winloss: -18.89,
    rtp: 121.84,
    uapSpin: 570,
    uapBet: 86.51,
    betSpin: 0.15
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 46,
    betAmount: 3.46,
    winloss: 2.61,
    rtp: 24.46,
    uapSpin: 46,
    uapBet: 3.47,
    betSpin: 0.08
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 39,
    betAmount: 9.79,
    winloss: -0.87,
    rtp: 108.97,
    uapSpin: 39,
    uapBet: 9.8,
    betSpin: 0.25
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 51,
    betAmount: 12.8,
    winloss: 3.2,
    rtp: 74.98,
    uapSpin: 51,
    uapBet: 12.81,
    betSpin: 0.25
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 6,
    betAmount: 1.41,
    winloss: 1.03,
    rtp: 26.67,
    uapSpin: 6,
    uapBet: 1.41,
    betSpin: 0.24
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 4,
    spin: 275,
    betAmount: 457.51,
    winloss: 215.77,
    rtp: 52.84,
    uapSpin: 68.75,
    uapBet: 114.38,
    betSpin: 1.66
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 6,
    spin: 514,
    betAmount: 627.07,
    winloss: 125.46,
    rtp: 79.99,
    uapSpin: 85.67,
    uapBet: 104.51,
    betSpin: 1.22
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 4,
    betAmount: 0.94,
    winloss: 0.94,
    rtp: 0,
    uapSpin: 4,
    uapBet: 0.94,
    betSpin: 0.24
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 6,
    betAmount: 3.61,
    winloss: 2.03,
    rtp: 43.75,
    uapSpin: 6,
    uapBet: 3.62,
    betSpin: 0.6
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 5,
    spin: 662,
    betAmount: 249.41,
    winloss: -79.92,
    rtp: 132.04,
    uapSpin: 132.4,
    uapBet: 49.88,
    betSpin: 0.38
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 2,
    spin: 161,
    betAmount: 60.65,
    winloss: -38.47,
    rtp: 163.43,
    uapSpin: 80.5,
    uapBet: 30.33,
    betSpin: 0.38
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 54,
    betAmount: 50.86,
    winloss: -25.43,
    rtp: 150,
    uapSpin: 54,
    uapBet: 50.86,
    betSpin: 0.94
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 5,
    spin: 1956,
    betAmount: 706.2,
    winloss: -27.42,
    rtp: 103.88,
    uapSpin: 391.2,
    uapBet: 141.24,
    betSpin: 0.36
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 5,
    spin: 322,
    betAmount: 197.04,
    winloss: 80.02,
    rtp: 59.39,
    uapSpin: 64.4,
    uapBet: 39.41,
    betSpin: 0.61
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 36,
    betAmount: 8.79,
    winloss: 4.95,
    rtp: 43.66,
    uapSpin: 36,
    uapBet: 8.79,
    betSpin: 0.24
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 149,
    betAmount: 35.08,
    winloss: -11.25,
    rtp: 132.08,
    uapSpin: 149,
    uapBet: 35.09,
    betSpin: 0.24
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 2,
    spin: 71,
    betAmount: 23.41,
    winloss: 13.34,
    rtp: 43,
    uapSpin: 35.5,
    uapBet: 11.71,
    betSpin: 0.33
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 2,
    spin: 477,
    betAmount: 159.2,
    winloss: 0.18,
    rtp: 99.88,
    uapSpin: 238.5,
    uapBet: 79.6,
    betSpin: 0.33
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 2,
    spin: 77,
    betAmount: 18.68,
    winloss: 11.28,
    rtp: 39.62,
    uapSpin: 38.5,
    uapBet: 9.34,
    betSpin: 0.24
},
{
    source: 'vendor',
    vendor: 'gen',
    date: '2019-05-01',
    filename: '1558596576000.png',
    currency: 'THB',
    type: 'slot',
    uap: 1,
    spin: 40,
    betAmount: 37.67,
    winloss: 9.79,
    rtp: 74,
    uapSpin: 40,
    uapBet: 37.68,
    betSpin: 0.94
}];

//const model = require('./app/controllers/vendors/gen');
//model.bulkCreate(data);
test = async() => {
    const bcrypt = require('bcryptjs');
    var salt = bcrypt.genSaltSync(10);
    var hash = bcrypt.hashSync("B4c0/\/", salt);
    //console.log(salt);
    //const model = db.user;
    
    const test = await resolveData();
    //const test = model.createUser({ firstname: 'cy', lastname: 'lim', email: 'limcy@example.com', password: '123qwe'});
    console.log(test);
}

test2 = () => {
    let hash = Object.create(null);
    let grouped = [];
    const keys = ['currency', 'type'];
    const values = ['uap', 'spin', 'betAmount', 'winloss', 'rtp', 'uapSpin', 'uapBet', 'betSpin'];

    data.forEach((obj) => {
        let key = keys.map(function (k) { return obj[k]; }).join('|');
        if(!hash[key]) {
            hash[key] = { currency: obj.currency, type: obj.type, uap: 0, spin: 0, betAmount: 0, winloss: 0, rtp: 0, uapSpin: 0, uapBet: 0, betSpin: 0 };
            grouped.push(hash[key]);
        }
        values.forEach(function (k) { hash[key][k] += obj[k]; });
    });
    console.log(grouped);
};

test3 = () => {
    var array = [
        { shape: 'square', color: 'red', edge:5, used: 1, instances: 1, percent:10 }, 
        { shape: 'square', color: 'red', edge: 4, used: 2, instances: 1, percent: 10 }, 
        { shape: 'circle', color: 'blue', edge: 4, used: 0, instances: 0, percent: 10 }, 
        { shape: 'square', color: 'blue', edge: 4, used: 4, instances: 4, percent: 10}, 
        { shape: 'circle', color: 'red', edge: 4, used: 1, instances: 1, percent: 10}, 
        { shape: 'circle', color: 'red', edge: 4, used: 1, instances: 0, percent: 10}, 
        { shape: 'square', color: 'blue', edge: 4, used: 4, instances: 5, percent: 10}, 
        { shape: 'square', color: 'red', edge: 4, used: 2, instances: 1, percent: 10}],
        hash = Object.create(null),
        grouped = [];

    array.forEach(function (o) {
        var key = ['shape', 'color', 'edge'].map(function (k) { return o[k]; }).join('|');
        if (!hash[key]) {
            hash[key] = { shape: o.shape, color: o.color, edge:o.edge, used: 0, instances: 0, percent:0 };
            grouped.push(hash[key]);
        }
        ['used', 'instances', 'percent'].forEach(function (k) { hash[key][k] += o[k]; });
    });

    console.log(grouped);
}

test4 = async() => {
    //let unresolved = [['1', '05/01/2019', 'THB', '27,216', '16,116,913.00', '13,694,604.50', '-485,329.10', '31,933.45', '-453,395.65', '453,395.65', '48,532.91']]; // CMD
    //let unresolved = [["Totals CNY (0)", "39", "51111", "CNY225,121.4301", "CNY225,121.4301", "CNY223,136.2300", "99.1%", "CNY223,136.2300", "CNY1,985.2001", "99.1%", "0", "CNY0.0000", "CNY0.0000", "CNY0.0000", "0", "CNY891.0999", "CNY94.8500", "0", "CNY0.0000", "CNY0.0000", "CNY0.0000"]]; // PT
    //let unresolved = [['Slots','30','100.00','2301.50','3.75','100.00','963','36.05','00:06:31','2299.30','0.00','0.00','2.20','0.10','0.00','0.00']]; //gen
    //let unresolved = [['', '1.', 'THB', '228', '27', '108,262', '120,820', '821,384.95', '-56,007.61', '56,007.61', '6.82', '0.00', '0.00'], ['', '2.', 'CNY', '3', '1', '415', '421', '729.80', '-305.82', '305.82', '41.90', '0.00', '0.00']]; //pgs
    //let unresolved = [['Welton Holdings Limited-RB88.com', 'Thai Baht', '284', '109,189', '109,279', '488,233.46', '37,182', '445,382.58', '1,962.17', '40,888.71', '8.37'], ['Welton Holdings Limited-RB88.com', 'Yuan Renminbi', '49', '27,854', '27,854', '263,675.01', '9,074', '259,742.09', '1.28', '3,931.64', '1.49']];
    //let unresolved = [ [ '1', 'LT118', 'RMB', '3', '856', '2,307.00', '2,307.00', '2,307.00', '2,307.00', '-431.80', '0.00', '-18.72%', '\nPlayers\n \nBrand Game Provider\n \nDaily Brand' ], [ '2', 'LT118', 'THB', '438', '261,562', '1,022,170.00', '1,022,170.00', '1,022,170.00', '1,022,170.00', '36,614.95', '0.00', '3.58%', '\nPlayers\n \nBrand Game Provider\n \nDaily Brand' ] ]; //tgp
    //let unresolved = [['rb88', 'Normal', '3736', '15', 'CN', 'CNY', '16056.20', '11164.09', '69.53%', '4892.11'], ['rb88', 'Normal', '96017', '249', 'CN', 'THB', '2040238.00', '1969525.73', '96.53%', '70712.26']]; //ygg
    //let unresolved = [['Live Game', 'CNY', '26', '2520', '876,790.00', '792,360.00', '-13,901.00', '0'], ['Live Game', 'THB', '659', '65819', '8,048,825.51', '7,285,958.81', '-189,623.71', '0']]; //GD
    //let unresolved = [['', 'CNY', '2,517', 'CNY 1,849,465.12', 'CNY 734.78', '257', 'CNY 7,294.42', 'CNY 28.38', '0.39%']]; //sbt
    //let unresolved = [['人民币', '360', '16,138', '6,475,996.00', '5,789,205.90', '147,034.90', '0.00', '0.00', '0.00', '0.00', '0.00', '0.00', '-147,034.90'], ['泰珠', '1,148', '116,362', '36,536,811.00', '32,701,900.00', '-435,725.80', '0.00', '0.00', '0.00', '0.00', '0.00', '0.00', '435,725.80']]; //AGL
    //let unresolved = [['B70', '15', '79,130', '142,385.6000', '142,385.6000', '-7,609.3171', '572.0229']]; // ag
    //let unresolved = [['Details\n', 'Client', 'bz8bpy5', 'Real Games', '130,783.00', '-607.25', '115,698.75', 'Live Casino', '0.00', '0.00', '-607.25', '94.00', '7,846.98', '-36.44', '6,941.92', '-36.44', '-0.4643']]; // AB
    //let unresolved = [['1', 'CNY', '27', '52', '21,454.3000', '20,701.00', '621.0300', '5,856.5900', '5,988.8600', '-753.3000(-753.3000)'], ['2', 'THB', '33', '59', '25,210.1200', '13,927.30', '417.8190', '-9,308.3700', '1,556.6310', '-11,282.8200(-11,282.8200)']]; //bettrade
    let unresolved = [['1', 'RMB', 'MAY', '1.0000', '447', '4,623', '2,910,316.27', '2,896,315.20', '-350,536.35', '-12.10', '52', '21,464.30', '21,454.30', '20,701.00', '5,856.59', '753.30', '6,609.89', '-357,146.24'], ['2', 'THB', 'MAY', '0.2178', '354', '3,168', '199,946.09', '199,718.13', '-430.93', '-0.21', '59', '5,504.22', '5,490.76', '3,033.36', '-2,027.37', '2,457.39', '430.03', '-860.97']]; //IPSB
    const _resolver = require('./app/services/system/resolver');
    const db = require('./app/config/db');
    const source = 'vendor'
    const vendor = 'ipsb';
    const brand = 'RB88';
    const currency = 'cny';
    const date = '2019-05-01';
    const filename = '34244434.png';
    const resolved = await _resolver.resolveParser({ source, brand, vendor, filename, date, currency }, unresolved);
    console.log(resolved);
}

test5 = async() => {
    const path = require('path');
    //const filename = '100-Sales-Records.zip' // zipped with single file
    //const filename = 'Sales-Records.zip' // zipped with multiple files
    //const filename = 'dataset.csv' // CSV
    const filename = 'ProfitAndLossReport.xlsx'; //Excel
    const filepath = path.join('./app/storages/downloads', filename);
    const extension = path.extname(filepath);
    const resolver = require('./app/services/resolver');
    const download = { filepath, filename, extension };
    const results = await resolver.resolveFile(download);
    const sheets = results[0].sheetNames;
    console.log(results[0].data[sheets[2]]);
    //console.log(results.result[sheets[1]]);
}

test6 = async() => {
    const dataframe = require('./app/services/dataframe');
    const summary = require('./app/services/database').summary.pt;
    console.log(summary);
    // const data = await model.getDatatable({ brand:'RB88', startDate:'2019-07-01' });
    // const compares = await model.getOnDuplicateValues();
    // const indexes = ['currency', 'date'];
    // console.log(dataframe.diff(data, compares, indexes));
    
}

test7 = async() => {
    const excel = require('./app/services/excel');
    const dataframe = require('./app/services/dataframe');
    const model = require('./app/services/database').cmd;
    const fs = require('fs');

    const brand = 'RB88';
    const vendor = 'CMD';

    const results = await model.getDatatable({ brand: 'RB88', startDate: '2019-07-01' });
    const compares = await model.getOnDuplicateValues();
    const indexes = ['currency', 'date'];
    const data = await dataframe.diff(results, compares, indexes);
    
    const file = await excel.convertDataToWorkbook({brand, vendor}, data);

    console.log(file);
};

test8 = async() => {
    const fs = require('fs');
    const path = require('path');
    const resolver = require('./app/services/resolver');
    const directory = path.join(__dirname, './app/storages/');
    const date = '2019-06-01';
    // const file = await resolver.resolvePath(directory, 'txt', "hello world", (file, content) => {
    //     fs.writeFileSync(file.filepath, content);
    //     return file;
    // });

    const file = await resolver.resolvePath(directory, 'png', {date});

    console.log(file);
}

test9 = async() => {
    const dataframe = require('dataframe-js').DataFrame;
    const currency = require('./app/services/currency');
    const df = new dataframe([['人民幣', '39', '52041', 'CNY225,121.4301'], ['泰铢', '1', '1', 'CNY1.000']], ['currency']);
    //const changed = df.castAll([(val) => { return val === '人民幣' ? 'cny' : 'thb' }, Number, Number, (val) => currency.convert(val, 4)]);
    //console.log(changed.withColumn('source', () => 'vendor').withColumn('date', () => '2019-05-01').toCollection());
    console.log(df.toCollection());
}

test10 = async() => {
    const resolver = require('./app/services/resolver');
    const path = require('path');
    const brand = 'RB88';
    const source = 'vendor';
    const vendor = 'PT';
    const date = '2016-06-01';
    const report = 'summary';
    const currency = 'cny';
    const filename = 'summary_games_stats.csv';
    const filepath = path.join('./app/storages/downloads', filename);
    const unresolved = await resolver.resolveFile({filename, filepath});
    unresolved.shift();
    const data = resolver.resolveParser({ brand, source, vendor, report, date, currency}, unresolved);
}

test10();